% Chapter Template

\chapter{Memristor Simulation} % Main chapter title

\label{Chapter5} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

\lhead{Chapter 5. \emph{Memristor Simulation}} % Change X to a consecutive number; this is for the header on each page - perhaps a shortened title

A numerical method for a memristor simulation was developed and tested in previous chapters based on drift-diffusion equations and finite difference. This chapter introduces the memristor's structure and physical parameters used for the simulation. It continues with a preliminary problem analysis to determine required mesh density and maximum possible time step. This preliminary analysis is followed by 1-D simulations of a memristor under various conditions.

\section{Memristor Structure}
%-Problem Analysis and assumptions, semiconductor vs memristor plots
Following figure (\ref{MemStc}) shows the structure of a simple memristor which will be taken as a basis for all the memristor simulations presented in this thesis. It consists of 2 metal contacts, a polymer conductor (PEDOT:PSS) and an electrolyte solution which has lithium and perchlorate ions ($\approx$ 6.02 $10^{23} m^{-3}$). The memristor is about 1 cm long and 1 mm wide. The thickness of the conductive layer is around 1 $\mu$m. During experimentation the electrolyte is deposited on PEDOT via a syringe so its thickness can vary drastically but as long as the amount of ions in the electrolyte solution is enough to saturate PEDOT this does not make a significant difference in the operation of the memristor. For simulation it was assumed that there were always more than enough ions to saturate the PEDOT so the electrolyte was modeled as an infinite source/sink of ions. The top boundary of the electrolyte was assumed to be charge neutral at all times which provides a mechanism for moving ions in and out of the system. This way the movement of ions near the surface of the PEDOT can still be captured without having to simulate the ion movement for the entire electrolyte solution which is variable in size. 

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.7]{Mem1}
\caption{} 
\label{MemStc}
\end{figure}

The initial conditions for all the charge carriers are the same. All charge are balanced and uniformly distributed but the carrier density in the electrolyte solution is higher than the carrier density in PEDOT. Perchlorate ions are not allowed to move outside the electrolyte solution so a no flow boundary condition was used around the electrolyte. Lithium ions are free to move between PEDOT and the electrolyte solution but their maximum concentration is limited inside the PEDOT. The mobility of lithium ions has further restrictions inside PEDOT. Lithium has higher mobility in PEDOT right under the electrolyte solution, wet PEDOT, than the region without any contact with electrolyte, dry PEDOT. In fact due to this difference very little amount of lithium reaches the metal contacts. This dec{rease in mobility was modeled by making the mobility of lithium a function of position. The mobility of lithium ions were assumed to be 100 times slower than the mobility of holes ( $\mu_{hole} \approx$ $10^{-3}$ $m^2/Vs$).  

PEDOT:PSS is a regular conductor with fixed negative charge and mobile holes. Holes can move in an out of the PEDOT through the metal contacts which hold the charge neutrality of the initial condition throughout the simulation. The interface between PEDOT and electrolyte only allows the exchange of lithium ions. During simulation,the movement of lithium ions changes the conductivity of the PEDOT by increasing or decreasing the amount of available holes through coulomb forces. In the actual device lithium ions change the conductivity via various physical effects like changing the mobility of holes through modifying their hopping distance. Even though the mobility of the holes can simply be made a function of time the physical details of these additional affects are beyond the scope of this thesis. 


\clearpage
\section{Simulation Requirements}

It is important to analyze computational requirements of a simulation in order to asses the feasibility of the computation scheme. In this case, it is possible to determine these spacial and temporal requirements using the equations \ref{debye} to \ref{CFL_Drift} which describe physical and numerical limitations of the simulation. Following graph \ref{SpaceTime} shows the requirements for a memristor of the scale discussed above and a typical semiconductor device around 1 $\mu$m. The mesh density has to be high enough in order to capture the exponential charge accumulation for charge shielding so the minimum step size was set to be 5 times smaller than the Debye length. Plots \ref{SpaceTime}.a and \ref{SpaceTime}.c show the amount of points required to simulate a semiconductor and a memristor based on minimum step size. It is important to note that these values are for 1-D simulation and they can be converted to 2-D and 3-D by squaring or cubing y axis values respectively. Plots \ref{SpaceTime}.b and \ref{SpaceTime}.d were created using CFL conditions for drift and diffusion and dielectric relaxation time. A typical simulation time was estimated using mobility and electric field. Based on the estimated simulation time the number of time steps were calculated using the minimum time step obtained from CFL conditions and dielectric relaxation time.

It can be seen from graphs \ref{SpaceTime}.a and \ref{SpaceTime}.c that memristor simulations require much higher mesh densities compared to a typical semiconductor simulation such as 1 $\mu$m long PN diode. This is due to the larger size and higher charge density of the memristor. Graph \ref{SpaceTime}.a \ref{SpaceTime}.b show that a memristor with $10^{26}$ $m^{-3}$ charge density of the electrolyte would require close to $10^9$ points and $10^{14}$ time steps to simulate in 1-D. These requirements make the simulation of the memristor extremely challenging. In order investigate and find possible solutions for this issue, first a memristor low charge density ($\approx 10^{15}$) was simulated in order to ensure that the simulation functions as designed. Then memristors with different charge densities were simulated and compared with each other to asses whether the behavior at low charge densities will be comparable to behavior at high charge densities.

\begin{landscape}
\begin{figure}[htp]
\centering
\includegraphics[scale=0.60]{SpaceTime}
\caption{Spatial and temporal requirements for simulation} 
\label{SpaceTime}
\end{figure}
\end{landscape}


\clearpage
\subsection{1-D Memristor Approximation}

The horizontal cross section from figure \ref{MemStc} has the most crucial elements of the memristor but its simulation in 1-D is not straight forward. Horizontal cross section through the PEDOT does not include the vertical movement of lithium. Without this effect PEDOT is just a regular conductor with a uniform current density. In order to overcome this problem a generation/recombination term for lithium ions, calculated at every time step, was added to capture the vertical movement in addition to regular drift diffusion equations which represents the horizontal movement. This generation/recombination term can be represented as a current source with a resistor connected to all the nodes (figure \ref{MemStc15}). Perchlorate ions were not included since they do not move into the PEDOT.

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.74]{1DMem}
\caption{1.5-D Memristor Structure} 
\label{MemStc15}
\end{figure}

The lithium source has two different terms, one for drift and another one for diffusion. It was assumed that the concentration of lithium was always constant in the electrolyte. This way the vertical diffusion current density can be calculated using the difference between the lithium density in PEDOT and electrolyte. For the diffusion term an electric field had to be estimated between the PEDOT and the electrolyte. First the potential of the electrolyte was assumed to be half of the net applied potential. Then an electric field was calculated using the electrolyte and the potential of the PEDOT at different positions.
 
 \clearpage
 \subsection{1-D Memristor Simulation Using a Pulse Train}
  
rtot=rcontact+rdry+rwet+rdry+rcontact

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.45]{1DMemPulseTrain}
%\includegraphics[scale=0.60]{Ex5DCResistivity}
\caption{Change in resistivity over time due to applied potential} 
\label{MemRes}
\end{figure}

Figure \ref{MempLi} demonstrates the replacement of holes by lithium ions over time which directly effects resistivity. As lithium ions get pulled in from the electrolyte toward the contact they accumulate inside PEDOT and push holes out via coulomb forces. Decreased hole concentration in the PEDOT increases the resistivity of the material. This change in resistivity over time is illustrated in figure \ref{MemRes}.

\begin{landscape}
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.90]{1DMemDensityOverTime}
%\includegraphics[scale=0.40]{Ex5pNp_Time1}
\caption{Lithium and hole density distribution over time} 
\label{MempLi}
\end{figure}
\end{landscape}

\begin{landscape}
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.90]{1DMemResistivityOverTime}
\caption{Normalized resistivity over time} 
\label{}
\end{figure}
\end{landscape}

Figure \ref{MemVss} shows the potential at steady state. Charge accumulation and depletion occurs around wet/dry PEDOT interface since it acts as a wall for lithium.  

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.60]{1DMemPotentialSS}
\caption{Potential at steady state} 
\label{MemVss}
\end{figure}

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.60]{1DMemEfieldSS}
\caption{Electric field at steady state} 
\label{MemEss}
\end{figure}

\clearpage
\subsection{1-D Memristor Simulation With Increasing Charge Density}

AvDiffn = 100*mean(abs((Jn-J1)/J1))

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.50]{HoleDiff}
\caption{} 
\label{}
\end{figure}

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.50]{LithiumDiff}
\caption{} 
\label{}
\end{figure}


\begin{figure}[!htp]
\centering
\includegraphics[scale=0.50]{DensityDiff}
\caption{} 
\label{}
\end{figure}


\begin{figure}[!htp]
\centering
\includegraphics[scale=0.50]{AllDiff}
\caption{} 
\label{}
\end{figure}



\clearpage
\subsection{1-D Memristor Simulation Using a Sinusoid}


Following two figures were created using an AC potential at the contacts. First figure shows (\ref{Bowtie}) shows applied potential versus normalized current. Bow tie plot in this figure is the most commonly seen memristor plot which demonstrates the memory effect of the device since the output current depends on the past states of the device. (add arrows showing the direction of the current on the plot). 
\begin{landscape}
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.60]{BowtiefAll}
\caption{Normalized Current vs. applied potential at different frequencies} 
\label{Bowtie}
\end{figure}
\end{landscape} 

   
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.60]{BowtieCurr3f}
\caption{Normalized current over time} 
\label{}
\end{figure}


\begin{landscape}
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.90]{1DMemACResistivity}
\caption{Normalized resistivity over time (f = 5 Hz)} 
\label{}
\end{figure}
\end{landscape} 



\clearpage
\subsection{Changes in Conductivity due to Lithium/Hole Mobility and Applied Potential}

Hopping distance change due to lithium

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.70]{1DHoleMobility}
\caption{} 
\label{}
\end{figure}

Lithium mobility scaling to match experiment
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.70]{1DLithiumMobility}
\caption{} 
\label{}
\end{figure}

??????
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.70]{1DMem_V}
\caption{} 
\label{}
\end{figure}

\clearpage
\subsection{Experiment vs. Simulation}