% Chapter Template
%!TEX root=../main.tex
\chapter{1-D Memristor Simulation} % Main chapter title

\label{Chapter6} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

\lhead{Chapter 6. \emph{Memristor Simulation}} % Change X to a consecutive number; this is for the header on each page - perhaps a shortened title

\begin{doublespace}

A numerical method for a coupled ionic-electronic device simulation \tjsr{is}{was} developed and tested in previous chapters based on drift-diffusion equations and finite difference. This chapter introduces a 1-D approximation for \tjs{a} 2-D cross section of the memristor. Then 1-D simulations of a memristor are shown under various conditions.


\section{1-D Memristor Approximation}

For \tjs{the} 1-D simulation it is assumed that there are always more than enough ions to saturate the PEDOT:PSS so the electrolyte is modeled as an infinite source/sink of ions. The top boundary of the electrolyte is assumed to be charge neutral at all times which provides a mechanism for moving ions in and out of the system. This way the movement of ions near the surface of the PEDOT can still be captured without having to simulate the ion movement for the entire electrolyte solution which is variable in size. This assumption is not used for 2-D simulations since the electrolyte is fully simulated.
 
The horizontal cross section from figure \ref{MemStc} has the most crucial elements of the memristor but its simulation in 1-D is not straightforward. This cross section through the PEDOT does not include the vertical movement of the lithium ions. Without this effect, PEDOT:PSS is just a regular conductor with a uniform current density. In order to overcome this problem a generation/recombination term for lithium ions (calculated at every time step) is added to capture the vertical movement in addition to the regular drift diffusion equations which represents the horizontal movement. This generation/recombination term can be symbolized as a current source with a resistor connected to all the nodes (figure \ref{MemStc15}). Perchlorate ions are not included in the simulation since they do not move into the PEDOT.

 
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.74]{1DMem}
\caption{1.5-D Memristor Structure. \tjs{Not sure about this. Are the R's and the sources in parallel. Can we give formulas for R and I?}} 
\label{MemStc15}
\end{figure}

The lithium source has two different terms, one for drift and another one for diffusion. It was assumed that the concentration of lithium is always constant in the electrolyte. This way the vertical diffusion current density can be calculated using the difference between the lithium density in PEDOT:PSS and electrolyte. For the \tjsr{diffusion}{drift?} term an electric field is estimated between the PEDOT:PSS and the electrolyte. First the potential of the electrolyte is assumed to be half of the net applied potential. Then an electric field is calculated using the electrolyte and the instantaneous potential of the PEDOT at different positions. \tjs{The 1D model therefore models the flow of Lithium in and out of the PEDOT as a strictly vertical 1D flow.}

\clearpage
\section{1-D Memristor Simulations}

The following simulations are made based on the memristor approximations discussed above. The first two simulations are repeated in the next chapter using a 2-D drift diffusion and Poisson solver which captures a broader range of physical effects. Both approaches are compared in order to understand their advantages and disadvantages under different circumstances.

\subsection{1-D Memristor Simulation Using a Potential Pulse Train}
  
For the following simulation a potential pulse train, slow enough to let the memristor reach steady state \tjs{between transitions}, is applied at the left contact.
\begin{figure}[!htp]
\centering
\includegraphics[scale=0.55]{1DMemPulseTrain}
%\includegraphics[scale=0.60]{Ex5DCResistivity}
\caption{Change in current density over time due to applied potential} 
\label{MemResTrain}
\end{figure}
\tjsr{Following plot}{Plot} \ref{MemResTrain} shows the current density output for both contacts separately. As expected the current density of the device decreased as the lithium ions move in. Additionally, it can be seen from the graph \ref{MemResTrain} that the current density output from left and right contacts are not always the same over the duration of the simulation. This is due to the PEDOT:PSS layer losing holes on one side and gaining holes on the other side which produces a difference in the measured current density between contacts. The scale of the difference depends on the rate of change in lithium movement on either side.

The current density in figure \ref{MemResTrain} shows a sudden increase when the potential is switched from 1 to 0 and vice versa. This sudden increase occurs because of the accumulation of lithium ions at the wet/dry interface which creates an opposing potential to the applied potential (see figure \ref{MemEss}). When the electric potential changes suddenly, \tjs{the} previously opposing electric field now helps the movement of holes and lithium towards the other end of the device. This additional electric field momentarily increases the current density output of the device.

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.70]{1DMemPot_Efield_SS}
\caption{Potential and electric field at steady state} 
\label{MemEss}
\end{figure}

Figure \ref{MempLi} demonstrates the replacement of holes by lithium ions over time which directly effects current density.  As lithium ions get pulled in from the electrolyte toward the contact they accumulate inside the PEDOT:PSS. Concurrently hole density decreases in areas where lithium accumulates. The decrease in the hole density in the PEDOT:PSS decreases the current density output of the memristor. This change in current density over time is illustrated in figure \ref{MemResTrain}.

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.65]{1DMemDensityOverTime}
%\includegraphics[scale=0.40]{Ex5pNp_Time1}
\caption{Lithium and hole density distribution over time} 
\label{MempLi}
\end{figure}

It is important to note that lithium ions are free to move in \textit{x} and \textit{y} directions. In figure \ref{MempLi} it can be seen that after the potential is switched as the lithium density moves from  side to the other. Most of the lithium movement happens through the exchange of ions between PEDOT:PSS and the electrolyte since the distance between them is far less than the length of the PEDOT. So most of the lithium ions, traveling from the positive to the negative contact, are pulled into the electrolyte before they reach the other side. Near the negative contact lithium ions are quickly pulled into the PEDOT:PSS and accumulate at the wet/dry interface. 

By examining the hole/lithium density plots of the PEDOT:PSS it is possible to conclude that it is composed of 3 distinct regions. 2 dry regions, where there is no contact with the electrolyte, have constant uniform resistance. Between these two resistances there is a variable non uniformly distributed resistance controlled by hole/lithium density and hole mobility. So this model captures the main characteristic of the memristor which is a variable charge dependent resistance where the resistance at any time depends on the past of the device. Following equation gives the total resistance/memristance for the memristor model developed for this thesis:

\begin{equation}
\centering
M(q(t))_{tot}=2R_{dry}+R(Li,p,\mu_{hole})
\end{equation}

The minimum resistance of this device is just the total resistance of the PEDOT:PSS without the lithium ions. The maximum resistance depends on different factors such as applied potential and the distribution and density of lithium ions inside \tjs{the} PEDOT:PSS.

\clearpage
\subsection{1-D Memristor Simulation Using a Sinusoid}

The memristor with a pulse train simulation shows the change in the current density over time due to an applied potential but it does not clearly demonstrate the memory effects. The memory effect of the memristor can be clearly demonstrated in an I-V curve using a sinusoidal potential. Following four graphs (figure \ref{Bowtie}) are created using an AC potential with different frequencies at the contacts. All the plots show that current density can have more than one value for the same potential at different times. This means that simulated memristor's past state\tjsr{s}{} affects its present output, therefore the device has \tjsr{a}{} memory. There is \tjsr{a pinch in the current for negative applied potential}{an asymmetry in the current curve} because it is measured from one contact which has relatively low change in resistance for a period of time during transient simulation. 

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.43]{BowtiefAll}
\caption{Normalized Current vs. applied potential at different frequencies} 
\label{Bowtie}
\end{figure}

The sudden changes in current around 0 V can be attributed to the density limiting mechanism for lithium. Instead of a slowdown in the movement of lithium ions near maximum density, the current flow into that region is completely blocked. Even though this makes the lithium density more responsive to changes, \tjsr{sudden movement block}{a sharp block in the flow} combined with large time steps can result in fast changes which can be directly seen as abrupt changes in the hole/lithium current density during transient simulations.  

The following plots (\ref{BowtieCurr}) show that, at first, there is a drop in the average current for all frequencies \tjsr{since lithium diffusion is greater than lithium drift}{as the lithium initially flows into the PEDOT:PSS}. This transient effect disappears once enough lithium settles into the PEDOT:PSS \tjs{to establish a stable distribution of lithium}. 

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.51]{BowtieCurr4f}
\caption{Normalized current over time} 
\label{BowtieCurr}
\end{figure}

Figures \ref{Bowhole} and \ref{Bowli} show the changes in the hole and lithium density in PEDOT:PSS over time. A visual comparison of the plots show that changes in the lithium density are tied to the changes in the hole density. As the frequency increases lithium diffusion becomes more dominant than lithium drift. At 100 Hz lithium drift due to the applied potential is barely present. Since the ions do not create a visible impact on the hole density, the resistivity of the device remains constant over time. This means that the memristor model behaves like a regular resistor at high frequencies.


\begin{figure}[!htp]
\centering
\includegraphics[scale=0.43]{1D_Memristor_Hole}
\caption{Hole density over time at different frequencies} 
\label{Bowhole}
\end{figure}

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.43]{1D_Memristor_Lithium}
\caption{Lithium density over time at different frequencies} 
\label{Bowli}
\end{figure}


\clearpage
\subsection{1-D Memristor Simulation With Increasing Charge Density \tjs{(I got a few questions)}}

After establishing that the simulation behaves as expected it is important to investigate how charge density effects this model since the size of the device limits the maximum charge density that can be simulated. The actual device has a hole density in the range of $ \approx 10^{26}$ $m^{-3}$ but the simulation is restricted to $\approx 10^{17}$ $m^{-3}$. In theory, if the densities used for the simulation \tjsr{does}{} have a limited affect on the behavior of the memristor then the simulations with low particle densities can be use as a proxy for the actual device which operates in much higher particle densities.

 The following 3 graphs (\ref{HoleDiff}, \ref{LithiumDiff} and \ref{DensityDiff} ) show the hole and the lithium densities at steady state as well as the current density over time at the right metal contact for various charge densities. The simulations are run using high mesh densities to allow stable simulation at high charge densities. 20 different simulations were made using densities ranging from $5$ x $10^{15}$  $m^{-3}$ to 1 x $10^{17}$  $m^{-3}$ but only 5 of them are plotted for illustration purposes. All the values are normalized to the initial plot using respective hole/lithium density ratios. Following equations ares used for the normalization procedure.
\begin{equation}
\centering
n_{norm}= \frac{n_i}{r} 
\end{equation}
\begin{equation}
\centering
J_{norm}= \frac{J_i}{r} 
\end{equation}
\begin{equation}
\centering
r = \frac{n_{initial}}{n_{0}}
\label{NormConst}
\end{equation}
\tjs{where} $n_{i}$ is the charge carrier density which could be either holes or lithium ions depending on the plot. \textit{J} is the current density calculated from the right metal contact, \textit{r} is the normalization constant which is calculated using initial carrier density ($n_{initial}$) of a simulation to be normalized and $n_{0}$ which is the carrier density of the initial plot ($5 x 10^{15}$ $m^{-3}$). After the normalization of various variables, all the plots are placed in the same graph to visually illustrate how increasing charge density affects the simulation. 

Plots for lithium ions (figure \ref{LithiumDiff}) and holes (figure \ref{HoleDiff}) are nearly identical to each other in terms of the plot shapes. They both get sharper around the area where there is a substantial accumulation of lithium. This is not unexpected since the debye length gets smaller with increasing carrier density. So with increased density it is expected that the density accumulation at the wet/dry PEDOT interface will be more narrow. This affect is not as strong for lithium ions since there is a maximum concentration limit on them. Lithium and hole plots only show the difference carrier density makes at steady state. The effect of debye length on the device operation can be further explored by looking at the current density over time.   

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.48]{HoleDiff}
\caption{Normalized hole densities at steady state} 
\label{HoleDiff}
\end{figure}

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.48]{LithiumDiff}
\caption{Normalized lithium densities at steady state} 
\label{LithiumDiff}
\end{figure}

\tjsr{F}{To investigate this the f}irst few milliseconds of \tjsr{this}{a} simulation is run without \tjs{allowing} the movement of lithium ions. At this stage normalized currents are identical to each other which means that a simulation with low density can be scaled up to any density without introducing any errors. The introduction of lithium ions slowly deviates the current plots from each other over time but the overall behavior of the memristor remains unchanged. The current density decreases over time and reaches a steady state value. After the first plot which has the lowest hole density, consecutive plots get closer and they are almost impossible to distinguish from each other at steady state.

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.48]{DensityDiff}
\caption{Normalized hole current densities} 
\label{DensityDiff}
\end{figure}

The impact of increasing charge density can be numerically explored using normalized plots. The following formula is used to calculate a percentage difference between different normalized carrier densities as well as normalized current densities. 

\begin{equation}
\centering
P_i^{n} = \frac{1}{ K}\sum_{k=1}^{K}\lvert 100 \;\frac{n_{i}(x_k)/r-n_{0}(x_k)}{n_{0}(x_k)}\rvert
\end{equation}

\begin{equation}
\centering
P_i^{J} = \frac{1}{ T}\sum_{k=1}^{T}\lvert 100 \;\frac{J_{i}(t_k)/r-J_{0}(t_k)}{J_{0}(t)}\rvert
\end{equation}

\textit{K} is for total number of points along \textit{x} axis and \textit{T} is the total number of time steps taken by the simulator. $x_{k}$ and $t_{k}$ are used to for a point in \textit{x} axis and a point in time respectively. \textit{r} is the normalization constant described in equation \ref{NormConst}. Both equations start by taking a point in either space (lithium/hole density) or time (current density) for a simulation with a certain carrier density and normalize them. After that point is normalized its difference from the lowest carrier density simulation is calculated as a percentage. Finally all the differences are averaged and used as a measure of the difference between simulations with different charge densities. They can also be used as an approximate error during scaling. 

\begin{figure}[!htp]
\centering
\includegraphics[scale=0.46]{AllDiff}
\caption{Average difference for hole, lithium and current densities for various initial hole densities} 
\label{AllDiff}
\end{figure}

Figure \ref{AllDiff} shows the difference hole/lithium density makes in the simulation. Carrier densities in the dry regions of the PEODT:PSS change very little between consecutive simulations since lithium ions do not reach there. For this reason only the densities at the wet PEDOT are used to measure the difference between plots. 

In all 3 cases, there is an increase in average difference for increasing carrier density. Hole density shows the most difference between plots. Since holes are free to move inside the PEDOT:PSS they \tjs{get} directly \tjsr{get}{} affected by the change in the Debye length due to the increase in hole density. This is not the case for lithium ions because their movement is restricted by the limit on lithium density. In contrast, current density is not as sensitive to density changes as lithium and hole distributions.


\tjs{ {\bf We need something like this --} An approximate error estimation can be made for current density if a low hole/lithium density is used for simulation and then scaled up to match the actual memristor. Figure \ref{AllDiff} shows a 3.3 \% difference for 2 orders of magnitude increase in the hole density. Assuming the error scales linearly after that point a total of 6 orders of magnitude will result in 9.9 \% error introduced in order to linearly scale from $10^{15}$ to $10^{21}$. The actual error is likely to be less since the error progresses sub linearly. Following the same procedure 6 orders of magnitude difference produces a 12 \% error for lithium distribution and 48 \% error for hole distribution. The difference in the hole distribution seems very large but the overall shape of the plot is always preserved since the highest amount change occurs around the wet/dry PEDOT interface where lithium accumulates. Based on these error margins and previous plots it can be concluded that the behavior of the memristor simulated using a low charge density is very similar to the simulation at a high charge density.    
}

\end{doublespace}
